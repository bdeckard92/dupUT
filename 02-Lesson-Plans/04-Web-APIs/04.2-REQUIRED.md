# Module 04 Virtual Class (Required): Web APIs

## Overview 

In today's required session, students will review timers, `localStorage`, and build a simple trivia game using DOM methods.


## Learning Objectives

By the end of class, students will be able to:

* Implement and explain timers and callbacks

* Store values in `localStorage`

* Build a simple web application using DOM methods


## Instructor Notes 

* In the module project, students will work with `localStorage` in the final lesson when they add persistence to their todo list and worked with it lightly in module 03, so they should have a general idea of how to use it.

* Students do not use timers in the module project, so this is the most important topic to convey today. They will need to use timers for the module challenge.

* The question game will get students used to the concept of manually iterating through an array of objects as opposed to using `for` loops. This combined with timers is very close to the module challenge's core functionality.


## Office Hours

Encourage students to work on the remaining module algorithms during office hours. Review the algorithm solutions 5–10 minutes before class begins or during office hours after class.


## Time Tracker 
@TODO INSERT TITLES
| Start  | #   | Activity Name                | Duration |
| ------ | --- | ---------------------------- | -------- |
| 6:00PM | 0   | Office Hours                 | 0:30     |
| 6:30PM | 1   | Introduction                 | 0:10     |
| 6:40PM | 2   | Review Current Challenge     | 0:05     |
| 6:45PM | 3   | Instructor Demo: Timers     | 0:05     |
| 6:50PM | 4   | Student Do: Timers      | 0:15     |
| 7:05PM | 5   | Instructor Review: Timers            | 0:10     |
| 7:15PM | 6   | Instructor Demo: localStorage             | 0:05     |
| 7:20PM | 7   | Student Do: localStorage                 | 0:15     |
| 7:35PM | 8   | Instructor Review: localStorage          | 0:10     |
| 7:45PM | 9   | Instructor Demo: Question Game             | 0:05     |
| 7:50PM | 10  | Student Do: Question Game                 | 0:20     |
| 8:10PM | 11  | Instructor Review: Question Game           | 0:10     |
| 8:20PM | 12  | Recap & Promote Resources    | 0:05     |
| 8:25PM | 13  | Introduce Upcoming Challenge | 0:05     |
| 8:30PM | 14  | Office Hours                 | 0:30     |
| 9:00PM | 15  | End                          | N/A      |
---

## Class Instructions

### 1. Introduction (10 min)

* Welcome students to class.

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ What did you learn this week? How would you explain it to your friends and family?

    * 🙋 We learned web APIs using `window` and Document Object Model. We are moving fast compared to traditional learners. It’s okay to feel overwhelmed as long as you don’t give up.

    * ☝️ Did anyone have an "Aha!" or "Eureka!" moment this week? When was it and why did things suddenly click for you? 

    * 🙋 Eureka moments happen when we try different approaches to a problem or change the way we're thinking about it.

    * ☝️ Did anyone feel stuck this week? How did you get unstuck?

    * 🙋 It's easy to get stuck when you're learning web development. It's important to learn how to get unstuck because it happens to the pros too. Rather than getting lost in search results, consult the tool's official documentation first. Then ask for help from instructional staff or your peers. Study groups are great because explaining your problems to someone else often reveals the solution. 


### 2. Review Current Challenge (5 min)

* Open `04-Web-APIs/02-Challenge/Master/index.html` in your browser and demonstrate the following:

    * This week's challenge is a coding quiz. 

    * When we click 'Start Quiz', we are presented with a series of multiple choice questions.

    * Starting the quiz also starts a timer.

    * When all questions are answered or time runs out, we are presented with our final score and a field to enter our initials. 

    * If we enter our initials, we will see them in listed on `/highscore.html`. If we close and reopen or refresh the application, our high score persists. 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ What recently acquired skills will help us build this challenge?

    * 🙋 Web APIs, specifically DOM methods and browser storage. 

    * ☝️ How are these skills relevant to a career in web development?

    * 🙋 Web APIs are fundamental to web development.

    * ☝️ How will this challenge improve your portfolio?

    * 🙋 Not only is this challenge a code quiz, it will showcase understanding web APIs, browser storage and timers. 

* Answer any questions before proceeding to the next activity.


### 3. Instructor Demo: Timers (5 min) 

* Open `03-Stu_timers/Solved/index.html` in your browser and demonstrate the following:

    * 🔑 When we open our application we are presented with a prompt asking, 'How many words per millisecond would you like to read?' 

    * 🔑 After we enter a value between 100 and 500, a countdown begins and a poem is rendered one word at a time in the browser. 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ Where have we used this before?

    * 🙋 We haven't used it before but it's a critical skill to have. So it's important to pay attention!

    * ☝️ How does this activity equip us for the challenge?

    * 🙋 The challenge uses a countdown. We will need to know how to update the DOM with timers.

    * ☝️ How would we build this?

    * 🙋 We would first prompt users for a numeric value, then create two timers, one for the countdown, and one for the speed reader itself. Within the speed reader timer, we would update the text in the DOM.

* Answer any questions before proceeding to the next activity.


### 4. Student Do: Timers (15 min) 

* Divide students into breakout rooms.

* Direct students to the activity instructions found in `03-Stu_timers/Unsolved`.

```md
    # Speed Reader 

    In this activity you are going to create a speed reading application. It will input a single word on the screen at a time, changing to the next word after 1 second. This equates to reading at 60 Words Per Minute (WPM).

    ## Instructions

    * The app should countdown from 5, and when the countdown is finished it should print one word to the screen every second. Each word replaces the other.

    * Open `index.html` and create the necessary HTML. You will need at least 3 elements.

    * Open `script.js`.

    * The two function names have been created for you, as well as a poem to speed read.

    * Fill out the necessary code that would create a countdown timer. When that timer completes, it should dissapear and speed reading should begin.
```


### 5. Instructor Review: Timers  (10 min) 

* Bring students back from breakout rooms. 

* Use the prompts and talking points below to review the following key (🔑) points:

    * ✔️ `setInterval()`

    * ✔️ `clearInterval()`

* Open `03-Stu_timers/Solved/script.js` in your IDE and explain the following: 

    * We first declare a `poem` variable with a string of text. We then use the `.split()` method to _split_ the string into individual elements in an array, `words`. 

    ```js
    var poem = "Some say the world will end in 🔥, Some say in ice. From what I’ve tasted of desire, I hold with those who favor fire. But if it had to perish twice, I think I know enough of hate. To say that for destruction ice, Is also great, And would suffice.";

    var words = poem.split(" ");
    ```

    *  We then use `getElementById()` to select the HTML elements with "main", "read", and "countdown" id's. We also creaet a `<div>` and assign it to `bodyEl`. 

    ```js
    var mainEl = document.getElementById("main");
    var readEl = document.getElementById("read");
    var timerEl = document.getElementById("countdown");
    var bodyEl = document.createElement("div");
    ```

    * We declare a global variable, `count`, to, well, do just that. We will use the `count` variable to track the state of our application as our timer runs.

    ```js
    var count = 0;

    ```

    * 🔑 We prompt the user for the number of milliseconds they would like between words and assign that value to `wordsPerMillisecond`.

    ```js
    var wordsPerMillisecond = prompt("How many words per millisecond would you like to read?");
    ```

    * 🔑 We declare a `prepareRead()` function. Within our `prepareRead()` function, we declare a `timeLeft` variable. This value will be used for the _count down_ prior to the speed reading. We next declare `timeInterval()` and assign it the value of `setInterval()`. `setInterval()` is a `window` method that repeatedly calls a function, or _callback_, based on a value, or _interval_, passed to it. Here, we will update the text in `timerEl` at an interval of 1000 ms, or 1 second. With each interval, we _decrement_ the value of `timeLeft`. If `timeLeft` is equal to 0, we use `clearInterval()` to stop `timeInterval()`. 

    ```js
    function prepareRead() {
        var timeLeft = 5;

        var timeInterval = setInterval(function() {
            timerEl.textContent = timeLeft + " seconds remaining";
            timeLeft--;

            if (timeLeft === 0) {
            timerEl.textContent = "";
            speedRead();
            clearInterval(timeInterval);
            }

        }, 1000);
        }
    ```

    * 🔑 We declare a `speedRead()` function and within it we first append our `bodyEl`. We then declare a `poemInterval` variable and, as above, assign it the value of `setInterval()`. Within our callback, we check if our `words` array contains anything. If not, we clear the interval. Otherwise, we update the `textContent` of `mainEl` with the string at `word[i]`. With each interval we increment `i`. Each interval is set to the length of `wordsPerMillisecond`, as input by the user. 

    ```js
    function speedRead() {

        var poemInterval = setInterval(function() {
            if (words[i] === undefined) {
            clearInterval(poemInterval);
            } else {
            mainEl.textContent = words[i];
            i++;
            }

        }, wordsPerMillisecond);
        }
    ```

    * Lastly, we call `prepareRead()` to run the application.

    ```js
    prepareRead();
    ```


* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ Why do we need to call `clearInterval()`?

    * 🙋 If we dont' call `clearInterval()`, our timer, `setInterval()`, will run indefinitely.

    * ☝️ What can you do if you don't completely understand this?

    * 🙋 @TODO We can refer to the lesson plan, read the [`setInterval()` docs on MDN](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.


### 6. Instructor Demo: localStorage  (5 min) 

* Open `04-Stu_localStorage/Solved/index.html` in your browser and demonstrate the following:

    * When opening the application, we are presented with a form to enter an 'Email' and a 'Password'. 

    * 🔑 If we enter an email and password, we see them rendered in the 'Last Registered User' panel. 

    * 🔑 If we close and reopen or refresh the browser, we see that our email and password persist. 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ Where have we used this before?

    * 🙋 We used this to accomplish saving our todo list, in lesson 5 of the module 04 project.

    * ☝️ How does this activity equip us for the challenge?

    * 🙋 The challenge uses browser storage to store high scores. 

    * ☝️ How would we build this?

    * 🙋 We would first scaffold our HTML and set up form fields for 'Email' and 'Password'. We would then write JavaScript to listen a click event on our form and render the values in the DOM.

* Answer any questions before proceeding to the next activity.


### 7. Student Do: localStorage  (15 min) 

* Divide students into breakout rooms.

* Direct students to the activity instructions found in `04-Stu_localStorage`.

```md
    # Local Storage

    * You have been provided with a signup form that successfully submits an email and password. You're job is to write code that saves the email and password to localStorage and renders the last submission to the page.

    ## Instructions

    * In your `signUpButton` event listener you will need to:

    * Save the user to localStorage.

    * In the `renderLastRegistered()` function you will need to:

    * Fill in code here to retrieve the last registered credentials from local storage.
    
    * If the last registered is null, return early from this function.
    
    * Else set the text of the `userEmailSpan`, `userPasswordSpan` to their corresponding values from local storage.
    
    ## Hints

    * Make sure you call `renderLastRegistered()` after you set your `localStorage`.
```


### 8. Instructor Review: localStorage  (10 min) 

* Bring students back from breakout rooms. 

* Use the prompts and talking points below to review the following key (🔑) points:

    * ✔️ @TODO { THIS }

    * ✔️ @TODO { THAT }

    * ✔️ @TODO { THE OTHER }

* Open `04-Stu_localStorage/Solved/index.html` in your IDE and explain the following: 

    * We set up our HTML form with two fields for 'Email' and 'Password' and a button to 'Sign Up'. Note the form method is `POST`.

    ```html
    <div class="card">
        <h2>Sign Up</h2>
        <form method="POST">
          <div class="input-group">
            <label for="email">Email</label>
            <input
              type="text"
              name="email"
              id="email"
              placeholder="janedoe@mail.com"
            />
          </div>
          <div class="input-group">
            <label for="password">Password</label>
            <input
              type="password"
              name="password"
              id="password"
              placeholder="supersecure123"
            />
          </div>
          <div id="msg"></div>
          <button id="sign-up">Sign Up</button>
        </form>
      </div>
    ```

* Open `04-Stu_localStorage/Solved/script.js` in your IDE and explain the following: 

    * We use `querySelector()` to select our DOM elements and assign them to variables.

    ```js
    var emailInput = document.querySelector("#email");
    var passwordInput = document.querySelector("#password");
    var signUpButton = document.querySelector("#sign-up");
    var msgDiv = document.querySelector("#msg");
    var userEmailSpan = document.querySelector("#user-email");
    var userPasswordSpan = document.querySelector("#user-password");
    ```

    * 🔑 We declare a `renderLastRegistered()` function. Within `renderLastRegistered()`, we query `localStorage` using the `getItem()` method for both "email" and "password" strings. If either "email" or "password" are null, our function returns. Otherwise, we render the values using the `textContent` property in the `userEmailSpan` and `userPasswordSpan` elements, respectively. 

    ```js
    function renderLastRegistered() {
        var email = localStorage.getItem("email");
        var password = localStorage.getItem("password");
        
        if (email && password === null) {
            return;
        }
        
        userEmailSpan.textContent = email;
        userPasswordSpan.textContent = password;
    }

    renderLastRegistered();
    ```

    * 🔑 We use `addEventListener()` on our `signUpButton` and listen for a "click" event. If there is a click event in the DOM on our `signUpButton`, we prevent the default functionality of the form, which is to `POST` the form content to a server. Instead, we use `querySelector` and the `value` property to assign the values in the form fields to `email` and `password` variables. If `email` and `password` are not empty strings, we store the values in `localStorage` using the `setItem` method.

    ```js
    signUpButton.addEventListener("click", function(event) {
        event.preventDefault();

        var email = document.querySelector("#email").value;
        var password = document.querySelector("#password").value;

        if (email === "") {
            displayMessage("error", "Email cannot be blank");
        } else if (password === "") {
            displayMessage("error", "Password cannot be blank");
        } else {
            displayMessage("success", "Registered successfully");

            localStorage.setItem("email", email);
            localStorage.setItem("password", password);
            renderLastRegistered();
        }
    });
    ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ Where _is_ `localStorage`?

    * 🙋 Values stored in `localStorage` are stored _locally_, in the users browser.  

    * ☝️ What can you do if you don't completely understanding this?

    * 🙋 @TODO We can refer to the lesson plan, read the [`localStorage` documentation on MDN](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.


### 9. Instructor Demo: Question Game  (5 min) 

* Open `05-Stu_Question-Game/index.html` in your browser and demonstrate the following:

    * 🔑 When we open the application, we are presented with a series of questions as confirmations.

    * 🔑 After answering all of the questions, we are presented with our score in an alert.

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ Where have we used this before?

    * 🙋 We used this to battle our enemy robots throughout the module 03 project.

    * ☝️ How does this activity equip us for the challenge?

    * 🙋 The challenge is an interactive coding quiz. This activity is very similar. 

    * ☝️ How would we build this?

    * 🙋 We would first scaffold boilerplate HTML, then create an object of question/answer pairs. Next, we would iterate over the questions, creating a `confirm()` for each.  

* Answer any questions before proceeding to the next activity.


### 10. Student Do: Question Game  (20 min) 

* Divide students into breakout rooms.

* Direct students to the activity instructions found in `05-Stu_Question-Game`.

```md
    # Question Game

    ## Instructions

    * Starting from a blank HTML file, create an array with 10 question objects. Each object in the array should be structured as follows: 

    `{ q: "QUESTION", a: "ANSWER" }`

    * Then create code that will ask the user questions, one by one. The user must answer by hitting OK (for true) or Cancel (for false).

    * Check the user's answer against the correct answer, and provide them with an alert telling them if they are right or wrong.
```


### 11. Instructor Review: Question Game  (10 min) 

* Bring students back from breakout rooms. 

* Use the prompts and talking points below to review the following key (🔑) points:

    * ✔️ Using an array of objects to store question / answer pairs

    * ✔️ Keeping score with a global variable

    * ✔️ Creating question / answer confirmations with iteration

* Open `05-Stu_Question-Game/index.html` in your IDE and explain the following: 

    * 🔑 @TODO 

    ```js
    var questions = [
        { q: 'The sky is blue.', a: 't' },
        { q: 'There are 365 days in a year.', a: 't' },
        { q: 'There are 42 ounces in a pound.', a: 'f' },
        { q: 'The Declaration of Independence was created in 1745.', a: 'f' },
        { q: 'Bananas are vegetables.', a: 'f' }
      ];

    var score = 0;
    ```

    * 🔑 @TODO DON'T FORGET TO USE THE KEY EMOJI ON KEY POINTS, BUT ONLY KEY POINTS, NOT _EVERY_ POINT

    ```js
    for (var i = 0; i < questions.length; i++) {
        // Display current question to user and ask OK/Cancel
        var answer = confirm(questions[i].q);

        // Compare answers
        if (
          (answer === true && questions[i].a === 't') ||
          (answer === false && questions[i].a === 'f')
        ) {
          // Increase score
          score++;
          alert('Correct!');
        } else {
          alert('Wrong!');
        }
      }
    ```
    
    * 🔑 @TODO DON'T FORGET TO USE THE KEY EMOJI ON KEY POINTS, BUT ONLY KEY POINTS, NOT _EVERY_ POINT

    ```js
    alert('You got ' + score + '/' + questions.length);
    ```


* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ @TODO { DO WE END OUR REVIEWS WITH A QUESTION? }

    * 🙋 @TODO { YES, WE DO! }

    * ☝️ What can you do if you don't completely understanding this?

    * 🙋 @TODO We can refer to the lesson plan, read the [{ DOCS }]({ URL }), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.


### 12. Recap & Promote Additional Resources (5 min)

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ What do you think you absolutely need to know to succeed at the challenge?

    * 🙋 @TODO { YES, WHAT? }

    * ☝️ What do you think is okay to not completely understand?

    * 🙋 All of it! The field of web development is very wide and rapidly evolving. Unless you choose to specialize, it is not necessary to know any one area completely to be successful. 

    * ☝️ Why is it important to do as much of the lesson material prior to class as possible?

    * 🙋 It's important both to be fully prepared to start the challenge and because it will prepare you for your future career as a web developer. We cover a lot of material in the boot camp. Lessons are intentionally designed to give each topic an optimal amount of depth and scope so that you have a solid foundation to build upon in future lessons. The skills you learn in the lessons are cutting-edge, real-world skills that you will use in your career as a full-stack web developer.

* Direct students to the additional resources available to them:

    * Reflection and Retrieval

    * Career Connection

    * Dessert Menu

### 13. Introduce Upcoming Challenge (5 min)

* Open `01-Class-Content/05-Third-Party-APIs/02-Challenge/Master/index.html` in your browser and demonstrate the following:

    * In the next challenge, we will be building a 'Work Day Scheduler'. 

    * The scheduler is composed of fields for the hours from 9AM to 5PM. We can enter values into the fields and if we click the 'Save' icon next to the field, the value will be stored in `localStorage`. 

    * Note that hours in the past are rendered as gray, the current hour is highlighted in red, and upcoming hours are green. 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ What are we learning?

    * 🙋 @TODO { YES, WHAT? }.

    * ☝️ How does this project build off or extend previously learned material?

    * 🙋 @TODO {YES, WHAT? }.

    * ☝️ How does this project relate to your career goals?

    * 🙋 @TODO { HOW DO COMPANIES USE IT IN INTERESTING WAYS? HOW POPULAR OR IN-DEMAND IS IT? WHY IS THE PROJECT ENTICING TO EMPLOYERS? }

* Answer any questions before proceeding to the next activity.

### 14. Office Hours (30 min)

* Announce office hours and encourage students to stay on the Zoom and start the challenge while they have live support from instructional staff. 


### 15. End 

How did today’s lesson go? Your feedback is important. Please take 5 minutes to complete [this anonymous survey](https://forms.gle/3LozVjherGH83aG17)

---
© 2019 Trilogy Education Services, LLC, a 2U, Inc. brand.  Confidential and Proprietary.  All Rights Reserved.
