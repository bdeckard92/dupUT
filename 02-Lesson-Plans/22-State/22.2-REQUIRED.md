# Module 22 Virtual Class (Required): State

## Overview 

In today's required virtual class, students will create a new context object for the global state, refactor the components to use the store, and practice reading the official documentation on Redux.


## Learning Objectives

By the end of class, students will be able to:

* Implement global state using React Context API

* Create custom a React Hook that utilizes the `useContext()` Hook

* Refactor existing code to use global state.

* Read and apply knowledge from official documentation


## Instructor Notes 

* Be sure to prepare and read over the activities before your class begins. Try to anticipate any questions students may have. 

* During activities, visit a few breakout rooms and check if the group is having any problems using `Book-Lounge` for their activities.

* **Important**: In order to avoid continuous NPM installs, all of today's activities' Solved and Unsolved folders include only a `src` folder. Similar to Module 20, use the given web application [Book-Lounge](../../01-Class-Content/22-State/01-Activities/Book-Lounge) and swap out the `src` folder for each activity. It's recommended that you completely restart the dev server between activities.

* Implementing global state using React Context API was covered in Lesson 1.

* This week's Challenge is refactoring the `Shop-Shop` e-commerce platform that students worked on throughout this module to use Redux. They will need to read through the official documentation by themselves and find the right information to help them accomplish their task. The `05-Redux-Docs` activity is a sample of what they need to do in order to succeed in the challenge. 

* Be prepared to announce project groups and go over the [project requirements](../../01-Class-Content/22-State/04-Supplemental/Project-Requirements.md)

## Office Hours

Encourage students to work on the remaining module algorithms during Office Hours. Review the algorithm solutions 5‚Äì10 minutes before class begins or during Office Hours after class.


## Time Tracker 

| Start  | #   | Activity Name                            | Duration |
| ------ | --- | ----------------------------             | -------- |
| 6:30PM | 0   | Office Hours                             | 0:30     |
| 7:00PM | 1   | Introduction                             | 0:10     |
| 7:10PM | 2   | Review Current Challenge                 | 0:05     |
| 7:15PM | 3   | Instructor Demo: Global State            | 0:05     |
| 7:20PM | 4   | Student Do: Global State                 | 0:15     |
| 7:35PM | 5   | Instructor Review: Global State          | 0:10     |
| 7:45PM | 6   | Instructor Demo: Global State Refactor   | 0:05     |
| 7:50PM | 7   | Student Do: Global State Refactor        | 0:15     |
| 8:05PM | 8   | Instructor Review: Global State Refactor | 0:10     |
| 8:15PM | 9   | Instructor Demo: Redux Docs              | 0:05     |
| 8:20PM | 10  | Student Do: Redux Docs                   | 0:20     |
| 8:40PM | 11  | Instructor Review: Redux Docs            | 0:10     |
| 8:50PM | 12  | Recap & Promote Resources                | 0:05     |
| 8:55PM | 13  | Introduce Group Project                  | 0:05     |
| 9:00PM | 14  | Office Hours                             | 0:30     |
| 9:30PM | 15  | End                                      | N/A      |

---

## Class Instructions

### 1. Introduction (10 min)

* Welcome students to class.

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è What did you learn this week? How would you explain it to your friends and family?

    * üôã We learned how to incorporate global state in our application so that we can avoid prop drilling. We learned how to create and utilize actions and reducers. We created a global store and incorporated indexedDB for offline capabilities. We even utilized Stripe API to process payments! We are moving fast compared to traditional learners. It‚Äôs okay to feel overwhelmed as long as you don‚Äôt give up.

    * ‚òùÔ∏è Did anyone have an "Aha!" or "Eureka!" moment this week? When was it and why did things suddenly click for you? 

    * üôã Eureka moments happen when we try different approaches to a problem or change the way we're thinking about it.

    * ‚òùÔ∏è Did anyone feel stuck this week? How did you get unstuck?

    * üôã It's easy to get stuck when you're learning web development. It's important to learn how to get unstuck because it happens to the pros too. Rather than getting lost in search results, consult the tool's official documentation first. Then ask for help from instructional staff or your peers. Study groups are great because explaining your problems to someone else often reveals the solution. 


### 2. Review Current Challenge (5 min)

* Navigate to `01-Class-Content/22-State/02-Challenge/Master` from the command line and run `npm start`.

    * We see the module project we've been working on throughout this module. But the difference here is that this application uses Redux to manage state instead of Context API.

    * The real challenge is to implement Redux by yourself by reading through the official documentation.

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è What recently acquired skills will help us build this challenge?

    * üôã The concept of global state and using actions and reducers to update the state is the same whether you use React Context API or Redux. So that knowledge of global state will help you with this challenge.

    * ‚òùÔ∏è How are these skills relevant to a career in web development?

    * üôã This last part of the boot camp has been focused more about being employer-ready than learning any new technologies or skills. We have been improving the skills you've already learned throughout this boot camp. But at a job, you will need not only coding skills but the ability to research, read documentation, and find the right information to solve your problem. That is the purpose of this challenge! To help you practice reading official documentation and use that knowledge to code. 

    * ‚òùÔ∏è How will this challenge improve your portfolio?

    * üôã It will show your knowledge and ability to incorporate not only React Context API but also Redux to implement global state.

* Answer any questions before proceeding to the next activity.


### 3. Instructor Demo: Global State (5 min) 

* Open `03-Global-State/Solved` in your IDE and demonstrate the following:

    * üîë Today we will be using the provided [Book-Lounge](../../01-Class-Content/22-State/01-Activities/Book-Lounge) app for all of our activities. 

    * üîë First, we copy the [src](../../01-Class-Content/22-State/01-Activities/03-Global-State/Solved/src) folder and paste it into the `Book-Lounge` app inside the `client` folder. 

    * üîë Then, we navigate to `Book-Lounge` in our command line and run `npm install` and `npm run seed` to set up the app.

    * üîë Start the app in dev mode by running `npm start`. The app will open automatically in the browser at <http://localhost:3000>

    * üîë We see a list of books. If we click one, it will render a new page with details of the book. Notice the header also changes to the title of the book you are viewing. When you go back to the list of books, the header reverts to "Now Viewing: Your book list". 

    * üîë The actions and reducers are already set up. We will now create a new context object for the global state.     

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è Where have we used this before?

    * üôã We use Context API to create the global state for the `Shop-Shop` app in Lesson 1.

    * ‚òùÔ∏è How does this activity equip us for the challenge?

    * üôã We will need to understand the concept and functionality of a global state in order to use Redux for the challenge. The syntax will be different but the concept will be the same.

    * ‚òùÔ∏è How would we build this?

    * üôã We need to create a `GlobalState.js` and a custom React Hook in order to instantiate and use the global state object. 

* Answer any questions before proceeding to the next activity.


### 4. Student Do: Global State  (15 min) 

* Divide students into breakout rooms.

* Direct students to the activity instructions found in `03-Global-State/README.md`.

```md
# Global State

In this activity, you will create a new context object for the global state.

## Instructions

* **Note** You will be using one web application, [Book-Lounge](../Book-Lounge), for all of our activities today.

* Copy the [src](Unsolved/src) folder and paste it into the [Book-Lounge](../Book-Lounge) app. 

* Navigate to [01-Activities/Book-Lounge](../Book-Lounge) and start the app in dev mode by running `npm start` from your command line.

* Check out the application running on <http://localhost:3000> in your browser. 

* In the `utils` folder, create a file called `GlobalState.js` and do the following:

  * Import `createContext` and `useContext` from react. Also import the `useBookReducer` function.

  * Instantiate the global state object.

  * Create a function called `StoreProvider` that will instantiate the initial global state using the `useBookReducer()` function. Remember to include an empty array for `books` and an empty object for `currentBook`. Return the `StoreContext`'s `<Provider>` component.

  * Create a custom React Hook called `useStoreContext` that uses the `useContext()` Hook to give access to the data the `StoreProvider` provider manages. 

  * Finally export both the `StoreProvider` and `useStoreContext()` Hook.

* Open [App.js](../Book-Lounge/client/src/App.js) and import the `StoreProvider` so that the global state will be available to all of the components.

  * Wrap all of the components in `<StoreProvider>`.

* Check the application running the browser to make sure everything still compiles and functions correctly. 

* Press `CTRL + C` to stop the server before moving on to the next activity.

## Hint(s)

* You can refer to the [React Docs on Context](https://reactjs.org/docs/context.html)
```


### 5. Instructor Review: Global State  (10 min) 

* Bring students back from breakout rooms. 

* Use the prompts and talking points below to review the following key (üîë) points:

    * ‚úîÔ∏è global state object

    * ‚úîÔ∏è `StoreProvider()`

    * ‚úîÔ∏è `useStoreContext`

    * ‚úîÔ∏è `<StoreProvider>`

* Open `03-Global-State/Solved/src/utils/GlobalState.js` in your IDE and explain the following: 

    * First we need to import `createContext` and `useContext` from React, as well as our `useBookReducer`.

    ```js
    import React, { createContext, useContext } from 'react';
    import { useBookReducer } from './reducers';
    ```

    * üîë Then we instantiate the global state object. When we run the `createContext()` function, it creates a new context object called `StoreContext`. This will hold our global state data and functionality so we can provide it throughout our app. We pull out the `Provider` from the `StoreContext` so that we can wrap our app in it to make the state data that's passed into it as a prop available to all other components. 

    ```js
    const StoreContext = createContext();
    const { Provider } = StoreContext;  
    ```

    * üîë Next we create a custom provider function, `StoreProvider` that will be used to manage and update our state using the `useBookReducer`. It will return the `<Provider>` component with the state object and dispatch the function provided as data for the `value` prop.

    ```js
    const StoreProvider = ({ value = [], ...props }) => {
      const [state, dispatch] = useBookReducer({
        books: [],
        currentBook: {}
      });
      return <Provider value={[state, dispatch]} {...props} />;
    };
    ```

    * üîë Then we create a custom React Hook called `useStoreContext`. When we use it, we will receive the `[state, dispatch]` data that the above `StoreProvider` gives us.

    ```js
    const useStoreContext = () => {
      return useContext(StoreContext);
    };
    ```

    * Finally we export both `StoreProvider` and `useStoreContext`

    ```js
    export { StoreProvider, useStoreContext };
    ```

* Open `03-Global-State/Solved/src/App.js` in your IDE and explain the following: 

    * In `App.js`, we wrap all of the components in `<StoreProvider>` so that the global state will be available to all of the components.

    ```js
    <StoreProvider>
        <Header currentBook={currentBook} />
        <div className="container">
            <Switch>
            <Route exact path="/" component={BookList} />
            <Route
                exact
                path="/book/:bookId"
                component={() => (
                <Detail
                    setCurrentBook={setCurrentBook}
                    currentBook={currentBook}
                />
                )}
            />
            <Route render={() => <h1>404! Wrong Page</h1>} />
            </Switch>
        </div>
    </StoreProvider>
    ```

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è Where have we seen a Provider component before?

    * üôã We used the `<ApolloProvider>` component to make our GraphQL API requests available to the entire application.

    * ‚òùÔ∏è What can you do if you don't completely understand this?

    * üôã We can refer to Lesson 1, read the [React Docs on Context](https://reactjs.org/docs/context.html), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.


### 6. Instructor Demo: Global State Refactor  (5 min) 

@TODO USE THE FOLLOWING FOR BROWSER AND/OR COMMAND LINE DEMOS, RESPECTIVELY. REMOVE IF UNUSED
* Open `@TODO/folder/file` in your browser and demonstrate the following:
* Run `@TODO/folder/file { AND ARGS, IF ANY }` from the command line and demonstrate the following: 

    * üîë @TODO { WHEN WE DO THIS, IT DOES THAT. }

    * üîë @TODO { WE ALSO SEE THESE THINGS. }

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è Where have we used this before?

    * üôã @TODO We used this to accomplish { X, Y, Z }, in { CORRESPONDING ASYNCHRONOUS LESSON PLAN }.

    * ‚òùÔ∏è How does this activity equip us for the challenge?

    * üôã @TODO { YES, HOW? } 

    * ‚òùÔ∏è How would we build this?

    * üôã @TODO { YES, HOW? } 

* Answer any questions before proceeding to the next activity.


### 7. Student Do: { ACTIVITY NAME }  (15 min) 

* Divide students into breakout rooms.

* Direct students to the activity instructions found in `@TODO/folder/file`.

```md
    @TODO add instructions; tabbed
```


### 8. Instructor Review: { ACTIVITY NAME }  (10 min) 

* Bring students back from breakout rooms. 

* Use the prompts and talking points below to review the following key (üîë) points:

    * ‚úîÔ∏è @TODO { THIS }

    * ‚úîÔ∏è @TODO { THAT }

    * ‚úîÔ∏è @TODO { THE OTHER }

* Open `@TODO/folder/file` in your IDE and explain the following: 

    * @TODO { WE DO THIS AND THE RESULT IS THAT }

    ```
    @TODO ADD CODE SNIPPET, TABBED
    ```

    * üîë @TODO DON'T FORGET TO USE THE KEY EMOJI ON KEY POINTS, BUT ONLY KEY POINTS, NOT _EVERY_ POINT

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è @TODO { DO WE END OUR REVIEWS WITH A QUESTION? }

    * üôã @TODO { YES, WE DO! }

    * ‚òùÔ∏è What can you do if you don't completely understand this?

    * üôã @TODO We can refer to the lesson plan, read the [{ DOCS }]({ URL }), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.


### 9. Instructor Demo: { ACTIVITY NAME }  (5 min) 

@TODO USE THE FOLLOWING FOR BROWSER AND/OR COMMAND LINE DEMOS, RESPECTIVELY. REMOVE IF UNUSED
* Open `@TODO/folder/file` in your browser and demonstrate the following:
* Run `@TODO/folder/file { AND ARGS, IF ANY }` from the command line and demonstrate the following: 

    * üîë @TODO { WHEN WE DO THIS, IT DOES THAT. }

    * üîë @TODO { WE ALSO SEE THESE THINGS. }

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è Where have we used this before?

    * üôã @TODO We used this to accomplish { X, Y, Z }, in { CORRESPONDING ASYNCHRONOUS LESSON PLAN }.

    * ‚òùÔ∏è How does this activity equip us for the challenge?

    * üôã @TODO { YES, HOW? } 

    * ‚òùÔ∏è How would we build this?

    * üôã @TODO { YES, HOW? } 

* Answer any questions before proceeding to the next activity.


### 10. Student Do: { ACTIVITY NAME }  (20 min) 

* Divide students into breakout rooms.

* Direct students to the activity instructions found in `@TODO/folder/file`.

```md
    @TODO ADD INSTRUCTIONS; TABBED
```


### 11. Instructor Review: { ACTIVITY NAME }  (10 min) 

* Bring students back from breakout rooms. 

* Use the prompts and talking points below to review the following key (üîë) points:

    * ‚úîÔ∏è @TODO { THIS }

    * ‚úîÔ∏è @TODO { THAT }

    * ‚úîÔ∏è @TODO { THE OTHER }

* Open `@TODO/folder/file` in your IDE and explain the following: 

    * @TODO { WE DO THIS AND THE RESULT IS THAT }

    ```
    @TODO ADD CODE SNIPPET, TABBED
    ```

    * üîë @TODO DON'T FORGET TO USE THE KEY EMOJI ON KEY POINTS, BUT ONLY KEY POINTS, NOT _EVERY_ POINT

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è @TODO { DO WE END OUR REVIEWS WITH A QUESTION? }

    * üôã @TODO { YES, WE DO! }

    * ‚òùÔ∏è What can you do if you don't completely understand this?

    * üôã @TODO We can refer to the lesson plan, read the [{ DOCS }]({ URL }), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.


### 12. Recap & Promote Additional Resources (5 min)

* Ask the class the following questions (‚òùÔ∏è) and call on students for the answers (üôã):

    * ‚òùÔ∏è What do you think you absolutely need to know to succeed at the challenge?

    * üôã @TODO { YES, WHAT? }

    * ‚òùÔ∏è What do you think is okay to not completely understand?

    * üôã All of it! The field of web development is very wide and rapidly evolving. Unless you choose to specialize, it is not necessary to know any one area completely to be successful. 

    * ‚òùÔ∏è Why is it important to do as much of the lesson material prior to class as possible?

    * üôã It's important both to be fully prepared to start the challenge and because it will prepare you for your future career as a web developer. We cover a lot of material in the boot camp. Lessons are intentionally designed to give each topic an optimal amount of depth and scope so that you have a solid foundation to build upon in future lessons. The skills you learn in the lessons are cutting-edge, real-world skills that you will use in your career as a full-stack web developer.

* Direct students to the additional resources available to them:

    * Reflection and Retrieval

    * Career Connection

    * Dessert Menu

### 13. Introduce Group Project (5 min)

* Announce the project groups.

    * This time, students will form the groups themselves. Keep them groups of 3.

    * Encourage the groups to set up a time this weekend to brainstorm project ideas.

    * Project ideas will be approved by the instructor by next week's Module 23 Recommended Class.

* Go over project requirements. 

    * Add the [project requirements](../../01-Class-Content/22-State/04-Supplemental/Project-Requirements.md) to the student-facing repo and go over them briefly.

```md
# Project Requirements

* Use React for the front end.

* Use GraphQL with a Node.js and Express.js server.

* Use MongoDB and the Mongoose ODM for the database.

* Use queries and mutations for retrieving, adding, updating, and deleting data.

* Be deployed using Heroku (with data).

* Meet the minimum requirements of a PWA:
	
  * Uses a web manifest

  * Uses a service worker for offline functionality

  * Is installable

* Have a polished UI.

* Be responsive.

* Be interactive (i.e., accept and respond to user input).

* Include authentication (JWT).

* Protect sensitive API key information on the server.

* Have a clean repository that meets quality coding standards (file structure, naming conventions, best practices for class and id naming conventions, indentation, high-quality comments, etc.).

* Have a high-quality README (with unique name, description, technologies used, screenshot, and link to deployed application).

Finally, you must add your project to the portfolio that you created in Module 20.

**More details about the project will be provided in the lessons for Module 23 in Canvas.**
```

* Let the students know detailed project information will be given in the async material for Module 23.

### 14. Office Hours (30 min)

* Announce Office Hours and encourage students to stay on the Zoom and start the challenge while they have live support from instructional staff. 


### 15. End 

How did today‚Äôs lesson go? Your feedback is important. Please take 5 minutes to complete [this anonymous survey](https://forms.gle/3LozVjherGH83aG17).

---
¬© 2020 Trilogy Education Services, LLC, a 2U, Inc. brand. Confidential and Proprietary. All Rights Reserved.
